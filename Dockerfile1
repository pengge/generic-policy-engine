FROM maven

WORKDIR /app
ADD . /app
RUN cd /app
ENV M2_HOME .m2
ADD settings.xml .m2/settings.xml
RUN mvn clean install

FROM openjdk
EXPOSE 8090
COPY --from=0  /app/target/policyengine-0.0.1-SNAPSHOT.jar /app/policyengine-0.0.1-SNAPSHOT.jar
WORKDIR /app
ENV M2_HOME .m2
ADD settings.xml .m2/settings.xml

#CMD ["java","-jar","policyengine-0.0.1-SNAPSHOT.jar","-Dkie.maven.settings.custom=.m2/settings.xml"] 
#CMD ["java","-jar","policyengine-0.0.1-SNAPSHOT.jar","-DrepoUrl=http://192.168.1.84:8081/repository/maven-group/"] 
CMD ["java","-jar","policyengine-0.0.1-SNAPSHOT.jar"]